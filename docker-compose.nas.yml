services:
  prunarr:
    image: prunarr:latest
    container_name: prunarr
    environment:
      - TZ=Europe/Amsterdam
      - LOG_LEVEL=info
      - LOG_FORMAT=json
    volumes:
      # Config file (single YAML file mount)
      - /volume3/docker/prunarr/prunarr.yaml:/app/config/prunarr.yaml
      
      # Data directory (jobs, exclusions)
      - /volume3/docker/prunarr/data:/app/data
      
      # Logs directory (optional - logs go to docker logs by default)
      - /volume3/docker/prunarr/logs:/app/logs
      
      # Symlink directory (read-write for Prunarr to create "Leaving Soon" symlinks)
      # This path must be accessible by both Prunarr and Jellyfin containers
      - /volume1/data/media/leaving-soon:/data/media/leaving-soon
      
      # Media paths (read-only) - MUST match Radarr/Sonarr/Jellyfin paths exactly
      # Prunarr needs to read source files to create symlinks
      - /volume1/data:/data:ro
    ports:
      - 8080:8080
    network_mode: bridge
    security_opt:
      - no-new-privileges:true
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
