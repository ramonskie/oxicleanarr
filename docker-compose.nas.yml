services:
  oxicleanarr:
    image: ghcr.io/ramonskie/oxicleanarr:latest
    container_name: oxicleanarr
    environment:
      # User/Group IDs - Match your NAS user (check with `id` command)
      # Synology default: 1026 or 1027, QNAP: varies
      - PUID=1027
      - PGID=65536
      
      - TZ=Europe/Amsterdam
      - LOG_LEVEL=info
      - LOG_FORMAT=json
    volumes:
      # Config directory (mount directory, not individual file)
      # NOTE: Add :z flag if using SELinux systems (Fedora, RHEL, CentOS)
      # Synology/QNAP users: :z flag is optional but harmless
      - /volume3/docker/oxicleanarr/config:/app/config
      
      # Data directory (jobs, exclusions)
      - /volume3/docker/oxicleanarr/data:/app/data
      
      # Logs directory (optional - logs go to docker logs by default)
      - /volume3/docker/oxicleanarr/logs:/app/logs
      
      # Media paths (read-write so OxiCleanarr can create symlinks)
      # MUST match Radarr/Sonarr/Jellyfin paths exactly
      # Mount ONLY the media directory for better security (not all of /volume1/data)
      # Adjust to match YOUR system structure:
      - /volume1/data/media:/data/media  # OxiCleanarr creates symlinks at /data/media/leaving-soon/
      
      # RECOMMENDED CONFIG: Use base_path: /data/media/leaving-soon in config.yaml
      # This way Jellyfin doesn't need an extra mount - it already has /data/media!
      
      # Alternative: Separate symlink directory (requires extra Jellyfin mount)
      # - /volume3/docker/oxicleanarr/leaving-soon:/app/leaving-soon
      # Then use base_path: /app/leaving-soon in config.yaml
      
      # Alternative path patterns (uncomment/modify based on your setup):
      # - /volume1/media:/media:ro           # If your media is at /volume1/media/
      # - /mnt/storage/media:/media:ro       # Custom storage location
      # - /volume1/data:/data:ro             # If you need more than just media (less secure)
    ports:
      - 9709:9709
    network_mode: bridge
    security_opt:
      - no-new-privileges:true
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:9709/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
